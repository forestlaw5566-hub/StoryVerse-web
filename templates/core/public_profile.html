{% extends 'core/base.html' %}

{% block title %}Perfil de {{ profile_user.username }}{% endblock %}

{% block content %}

<div class="text-center mt-4">

    <!-- Avatar -->
    <img src="{{ profile.avatar.url }}"
         style="width:120px;height:120px;border-radius:50%;object-fit:cover;border:3px solid #ff7db5;">

    <!-- Nombre de usuario -->
    <h2 class="mt-3">@{{ profile_user.username }}</h2>

    <!-- Biografía -->
    {% if profile.bio %}
        <p class="text-secondary">{{ profile.bio }}</p>
    {% else %}
        <p class="text-secondary">Este usuario no tiene biografía.</p>
    {% endif %}

    <!-- Contador seguidores y siguiendo -->
    <p class="text-light mt-2">
        <strong>{{ profile_user.followers.count }}</strong> seguidores · 
        <strong>{{ profile_user.following.count }}</strong> siguiendo
    </p>

    <!-- Botón Seguir / Dejar de seguir -->
    {% if user.is_authenticated and user != profile_user %}
        {% if is_following %}
            <a href="{% url 'toggle_follow' profile_user.username %}"
               class="btn btn-outline-light mt-2">
                Dejar de seguir
            </a>
        {% else %}
            <a href="{% url 'toggle_follow' profile_user.username %}"
               class="btn btn-pink mt-2"
               style="background:#ff7db5;color:white;">
                Seguir
            </a>
        {% endif %}
    {% endif %}
</div>

<hr class="my-4">

<!-- Historias publicadas -->
<h3>Historias publicadas</h3>

<div class="row mt-3">

    {% for story in stories %}
    <div class="col-md-3 mb-4">
        <a href="{% url 'story_detail' story.slug %}" class="text-decoration-none">
            <div class="card bg-dark text-light">
                {% if story.cover_image %}
                <img src="{{ story.cover_image.url }}" class="card-img-top"
                     style="height:180px;object-fit:cover;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ story.title }}</h5>
                </div>
            </div>
        </a>
    </div>

    {% empty %}
    <p class="text-secondary">Este usuario aún no tiene historias publicadas.</p>
    {% endfor %}

</div>

{% endblock %}
